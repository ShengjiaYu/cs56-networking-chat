<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClientWindow.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cs56-networking-chat</a> &gt; <a href="index.source.html" class="el_package">client.view</a> &gt; <span class="el_source">ClientWindow.java</span></div><h1>ClientWindow.java</h1><pre class="source lang-java linenums">package client.view;

import java.awt.*;
import java.awt.Color;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.event.*;
import javax.swing.JComboBox;
import java.awt.GraphicsEnvironment;
import javax.swing.*;
import java.awt.Dimension;
import java.util.Timer;
import java.util.TimerTask;
import java.io.IOException;

//Import random library
import java.util.Random;

import client.controller.ClientController;
import client.model.Client;
import client.model.Contact;

/**
 * Represents a JFrame window which has components that are needed for chatting
 * @author Peng Wang, Andro Stotts, Bryce Filler, Max Hinson
 * @version 0.4
 */
public class ClientWindow extends JFrame{

    private static final long serialVersionUID = 1L;
    private JTextField tfInput;
    private JTextArea taOutput;
    private JTextField tfUsername;
    private JTextField tfNickName;
    private JTextField tfServerIp;
    private JTextField tfChatRoomParticipants;
    private JPasswordField pfPassword;
    private JScrollPane spScrollPane;
    private JList&lt;String&gt; listContacts;
    private DefaultListModel&lt;String&gt; model;
    private String[] contactList;
    private JLabel lblContact;
    private JLabel lblUserName;
    private JLabel lblNickName;
    private JLabel lblPassword;
    private JLabel lblServerIp;
    private JLabel lblLoginError;
    private JLabel onlineCountNum;
    private JLabel onlineCountText;
    private JLabel userInRoom;
    private JCheckBox soundbox;
    private JButton btConnect;
    private JButton btNickname;
    private JButton btChangeFont;
    private JButton onlineCountUpdate;
    private JButton btAccept;
    private static ClientWindow window;
    private ClientController controller;
    private String name;
    private String nickname;
    private String ip;
    private String password;
    private JFrame nicknameWindow;
    private JFrame registrant;
    //    private JFrame editWindow;
    private int roomUsers;
    private int count;
    
 
    //Pre-determined color to randomly use
<span class="nc" id="L74">    java.awt.Color redColor = new java.awt.Color(255,000,000);</span>
<span class="nc" id="L75">    java.awt.Color greenColor = new java.awt.Color(000,255,000);</span>
<span class="nc" id="L76">    java.awt.Color blueColor = new java.awt.Color(000,000,255);</span>
<span class="nc" id="L77">    String names[] = {&quot;Black&quot;, &quot;Blue&quot;, &quot;Cyan&quot;,  &quot;Gray&quot;, &quot;Green&quot;, </span>
		       &quot;Orange&quot;, &quot;Pink&quot;, &quot;Red&quot;, &quot;White&quot;, &quot;Yellow&quot;};
    
<span class="nc" id="L80">    Color colors[] = {Color.BLACK, Color.BLUE, Color.CYAN, Color.GRAY, Color.GREEN, Color.ORANGE, Color.PINK, Color.RED, Color.WHITE, Color.YELLOW};</span>
    

<span class="nc" id="L83">    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();</span>
<span class="nc" id="L84">    Font fonts[] = ge.getAllFonts();</span>
    
   
    /**
     * Default constructor
     */
<span class="nc" id="L90">    private ClientWindow(){</span>
<span class="nc" id="L91">	controller = ClientController.getController();</span>
<span class="nc" id="L92">	tfInput = new JTextField();</span>
<span class="nc" id="L93">	taOutput = new JTextArea();</span>
<span class="nc" id="L94">	spScrollPane = new JScrollPane(taOutput);</span>
<span class="nc" id="L95">	taOutput.setLineWrap(true);</span>
<span class="nc" id="L96">	taOutput.setWrapStyleWord(true);</span>
<span class="nc" id="L97">	taOutput.setForeground(Color.ORANGE);</span>
<span class="nc" id="L98">	taOutput.setFont(new Font(&quot;default&quot;, Font.PLAIN, 12));</span>
<span class="nc" id="L99">	taOutput.setEditable(false);</span>
<span class="nc" id="L100">	model = new DefaultListModel&lt;String&gt;();</span>
<span class="nc" id="L101">	listContacts = new JList&lt;String&gt;();</span>
<span class="nc" id="L102">	listContacts.setModel(model);</span>
<span class="nc" id="L103">	lblContact = new JLabel(&quot;Contacts&quot;);</span>
<span class="nc" id="L104">	lblUserName = new JLabel(&quot;Username: &quot;);</span>
<span class="nc" id="L105">	lblNickName = new JLabel(&quot;New Nickname:&quot;);</span>
<span class="nc" id="L106">	lblServerIp = new JLabel(&quot;Server IP: &quot;);</span>
<span class="nc" id="L107">	lblPassword = new JLabel(&quot;Password: &quot;);</span>
<span class="nc" id="L108">	onlineCountText = new JLabel(&quot;Online Count: &quot;);</span>
<span class="nc" id="L109">	onlineCountNum = new JLabel(&quot;ERROR&quot;);</span>
<span class="nc" id="L110">	onlineCountUpdate = new JButton(&quot;Refresh&quot;);</span>
<span class="nc" id="L111">	onlineCountNum.setText(&quot;&quot;);</span>
<span class="nc" id="L112">	lblLoginError = new JLabel(&quot;&quot;);</span>
<span class="nc" id="L113">	tfUsername = new JTextField(20);</span>
<span class="nc" id="L114">	tfNickName = new JTextField(20);</span>
<span class="nc" id="L115">	tfServerIp = new JTextField(20);</span>
<span class="nc" id="L116">	tfChatRoomParticipants = new JTextField(20);</span>
<span class="nc" id="L117">	pfPassword = new JPasswordField(20);</span>
<span class="nc" id="L118">	btAccept = new JButton(&quot;Accept&quot;);</span>

	//default connection
<span class="nc" id="L121">	tfServerIp.setText(&quot;127.0.0.1&quot;);</span>
<span class="nc" id="L122">	soundbox = new JCheckBox(&quot;Play Sounds&quot;);</span>
<span class="nc" id="L123">	btConnect = new JButton(&quot;Connect to Server&quot;);</span>
<span class="nc" id="L124">	btNickname = new JButton(&quot;Accept&quot;);</span>
<span class="nc" id="L125">	name = &quot;&quot;;</span>
<span class="nc" id="L126">	password = &quot;&quot;;</span>
<span class="nc" id="L127">	ip = &quot;&quot;;</span>
<span class="nc" id="L128">    }</span>
	
    /**
     * get the instance of the ClientWindow object
     * @return instance of the ClientWindow 
     */
    public static ClientWindow getWindow(){
<span class="nc bnc" id="L135" title="All 2 branches missed.">	if(window == null){</span>
<span class="nc" id="L136">	    window = new ClientWindow();</span>
	}
<span class="nc" id="L138">	return window;</span>
    }
	
    /**
     * Creates the login window
     */
    public void launchLoginWindow(){
<span class="nc" id="L145">       	this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="nc" id="L146">	this.setLocation(100, 100);</span>
<span class="nc" id="L147">	this.setSize(300, 270);</span>
<span class="nc" id="L148">	this.setTitle(&quot;Chatting Client&quot;);</span>
<span class="nc" id="L149">	this.setLayout(new FlowLayout());</span>

<span class="nc" id="L151">	this.getContentPane().add(lblUserName);</span>
<span class="nc" id="L152">	this.getContentPane().add(tfUsername);</span>
<span class="nc" id="L153">	this.getContentPane().add(lblPassword);</span>
<span class="nc" id="L154">	this.getContentPane().add(pfPassword);</span>
<span class="nc" id="L155">	this.getContentPane().add(lblServerIp);</span>
<span class="nc" id="L156">	this.getContentPane().add(tfServerIp);</span>
<span class="nc" id="L157">	this.getContentPane().add(lblLoginError);</span>
<span class="nc" id="L158">	this.getContentPane().add(btConnect);</span>
<span class="nc" id="L159">	LoginListener loginListener = new LoginListener();</span>
<span class="nc" id="L160">	btConnect.addActionListener(loginListener);</span>
<span class="nc" id="L161">	tfUsername.addActionListener(loginListener);</span>
<span class="nc" id="L162">	pfPassword.addActionListener(loginListener);</span>
<span class="nc" id="L163">	tfServerIp.addActionListener(loginListener);</span>
<span class="nc" id="L164">	btConnect.setSelected(true);</span>
<span class="nc" id="L165">	this.setVisible(true);</span>
<span class="nc" id="L166">    }</span>
	
    /**
     * Creates the chat window
     * It will be invoked from the LoginListener
     */
    public void launchChatWindow(){
	//add window listener for closing window
	//which tells the server to broadcast the message
	//that this client is going offline
<span class="nc" id="L176">	this.addWindowListener(new WindowAdapter(){</span>
		public void windowClosing(WindowEvent we){
<span class="nc" id="L178">		    controller.sendMsg2Server(name + &quot;&amp;Broadcast:1003&quot;);</span>
<span class="nc" id="L179">		    System.exit(0);</span>
<span class="nc" id="L180">		}</span>
	    });
	
<span class="nc" id="L183">	this.getContentPane().removeAll();</span>
<span class="nc" id="L184">	this.setLayout(new BorderLayout());</span>
<span class="nc" id="L185">	this.setSize(1000, 500);</span>
<span class="nc" id="L186">	this.setTitle(&quot;Chatting Client-&quot; + name);</span>
<span class="nc" id="L187">	JPanel leftPanel = new JPanel();</span>
<span class="nc" id="L188">	JPanel rightPanel = new JPanel();</span>
<span class="nc" id="L189">	JPanel menuPanel = new JPanel();</span>

<span class="nc" id="L191">	menuPanel.add(onlineCountUpdate, BorderLayout.WEST);</span>
<span class="nc" id="L192">	menuPanel.add(onlineCountText, BorderLayout.WEST);</span>
<span class="nc" id="L193">	menuPanel.add(onlineCountNum, BorderLayout.WEST);</span>
<span class="nc" id="L194">	onlineCountUpdate.addActionListener(new OnlineCountUpdateButtonListener());	</span>
<span class="nc" id="L195">	menuPanel.setBorder(BorderFactory.createLineBorder(Color.black));</span>
<span class="nc" id="L196">	menuPanel.setLayout(new FlowLayout());</span>
<span class="nc" id="L197">	menuPanel.add(soundbox, BorderLayout.EAST);</span>
	

	

	
<span class="nc" id="L203">	FontCellRenderer fontCellRender = new FontCellRenderer();</span>
<span class="nc" id="L204">	JComboBox fontList = new JComboBox(fonts);</span>
<span class="nc" id="L205">	fontList.setRenderer(fontCellRender);</span>
<span class="nc" id="L206">	fontList.setPreferredSize(new Dimension(150,25));</span>
<span class="nc" id="L207">	menuPanel.add(fontList,BorderLayout.EAST);</span>

	//*************here i start to add stuff about change color***************
<span class="nc" id="L210">	ColorCellRenderer colorCellRender = new ColorCellRenderer();</span>
<span class="nc" id="L211">	JComboBox colorList = new JComboBox(colors);</span>
<span class="nc" id="L212">	colorList.setRenderer(colorCellRender);</span>
<span class="nc" id="L213">	colorList.setPreferredSize(new Dimension(100,25));</span>
<span class="nc" id="L214">	menuPanel.add(colorList,BorderLayout.EAST);</span>
	

<span class="nc" id="L217">	JButton deleteUser = new JButton(&quot;Delete User&quot;);</span>
<span class="nc" id="L218">	menuPanel.add(deleteUser,BorderLayout.EAST);</span>
<span class="nc" id="L219">	deleteUser.addActionListener(new DeleteUserButtonListener());</span>

<span class="nc" id="L221">	JButton logout = new JButton(&quot;Logout&quot;);</span>
<span class="nc" id="L222">	menuPanel.add(logout,BorderLayout.EAST);</span>
<span class="nc" id="L223">	logout.addActionListener(new LogoutListener());</span>
	
	
<span class="nc" id="L226">	rightPanel.setBorder(BorderFactory.createLineBorder(Color.black));</span>
<span class="nc" id="L227">	rightPanel.setLayout(new BorderLayout());</span>
<span class="nc" id="L228">	rightPanel.add(spScrollPane, BorderLayout.CENTER);</span>
<span class="nc" id="L229">	rightPanel.add(tfInput, BorderLayout.SOUTH);</span>
		
<span class="nc" id="L231">	leftPanel.setBorder(BorderFactory.createLineBorder(Color.black));</span>
<span class="nc" id="L232">	leftPanel.setLayout(new BorderLayout());</span>
<span class="nc" id="L233">	leftPanel.add(lblContact, BorderLayout.NORTH);</span>
<span class="nc" id="L234">	leftPanel.add(listContacts, BorderLayout.CENTER);</span>

<span class="nc" id="L236">	JButton nickName = new JButton(&quot;Change nickname&quot;);</span>
<span class="nc" id="L237">	JButton chatRoom = new JButton(&quot;Chat Room&quot;);</span>

	//new
<span class="nc" id="L240">	JButton editRoom = new JButton(&quot;Edit my room&quot;);</span>
        
<span class="nc" id="L242">	menuPanel.add(editRoom, BorderLayout.EAST);</span>
	
<span class="nc" id="L244">	leftPanel.add(nickName, BorderLayout.SOUTH);</span>
<span class="nc" id="L245">	leftPanel.add(chatRoom, BorderLayout.NORTH);</span>
	
		
<span class="nc" id="L248">	listContacts.setSelectedIndex(0);</span>
<span class="nc" id="L249">	onlineCountUpdate.addActionListener(new OnlineCountUpdateButtonListener());</span>
<span class="nc" id="L250">	onlineCountUpdate.doClick();</span>
		
<span class="nc" id="L252">	this.getContentPane().add(leftPanel, BorderLayout.WEST);</span>
<span class="nc" id="L253">	this.getContentPane().add(rightPanel, BorderLayout.CENTER);</span>
<span class="nc" id="L254">	this.getContentPane().add(menuPanel, BorderLayout.NORTH);</span>
<span class="nc" id="L255">	this.repaint();</span>
<span class="nc" id="L256">	tfInput.addActionListener(new InputListener());</span>
<span class="nc" id="L257">	chatRoom.addActionListener(new RegisterChatRoomListener());</span>
<span class="nc" id="L258">	nickName.addActionListener(new LaunchChangeWindowListener());</span>
	//editRoom.addActionListener(new ChatroomListener());
<span class="nc" id="L260">	fontList.addActionListener(new FontListener());</span>
<span class="nc" id="L261">	colorList.addActionListener(new ColorListener());</span>
<span class="nc" id="L262">	soundbox.addItemListener(new CheckListener());</span>
<span class="nc" id="L263">	soundbox.setSelected(true);</span>
<span class="nc" id="L264">	Timer timer = new Timer();</span>
<span class="nc" id="L265">	timer.schedule(new timerThread(),0,1000);</span>
		
<span class="nc" id="L267">    }</span>

    
    /**
     * Creates the name change window
     */
    public void launchChangeWindow(){
	//creates the window that appears
	//upon requesting to change user name
<span class="nc" id="L276">	nicknameWindow = new JFrame();</span>
<span class="nc" id="L277">	nicknameWindow.setLocation(100, 100);</span>
<span class="nc" id="L278">	nicknameWindow.setSize(300, 125);</span>
<span class="nc" id="L279">	nicknameWindow.setDefaultCloseOperation(EXIT_ON_CLOSE);</span>
<span class="nc" id="L280">	nicknameWindow.setTitle(&quot;Set Nickname&quot;);</span>
<span class="nc" id="L281">	nicknameWindow.setLayout(new FlowLayout());</span>
<span class="nc" id="L282">	nicknameWindow.getContentPane().add(lblNickName);</span>
<span class="nc" id="L283">	nicknameWindow.getContentPane().add(tfNickName);</span>
<span class="nc" id="L284">	nicknameWindow.getContentPane().add(btNickname);</span>
<span class="nc" id="L285">	nicknameWindow.setVisible(true);</span>
<span class="nc" id="L286">	btNickname.addActionListener(new ChangeNickNameListener());</span>
<span class="nc" id="L287">	tfNickName.addKeyListener(new ChangeNickNameListener());</span>

<span class="nc" id="L289">    }</span>

	/**Method to launch the window to register a new ChatRoom. Creates a popup window that prompts for the nicknames of the
	* participants who are part of the ChatRoom
	* @author jleeong
	* @version F16
	*/
	public void launchRegisterChatRoomWindow(){
<span class="nc" id="L297">		registrant = new JFrame();</span>
<span class="nc" id="L298">		registrant.setLocation(100, 100);</span>
<span class="nc" id="L299">		registrant.setSize(300, 125);</span>
<span class="nc" id="L300">		registrant.setDefaultCloseOperation(EXIT_ON_CLOSE);</span>
<span class="nc" id="L301">		registrant.setTitle(&quot;Set Nickname&quot;);</span>
<span class="nc" id="L302">		registrant.setLayout(new FlowLayout());</span>
<span class="nc" id="L303">		registrant.getContentPane().add(new JLabel(&quot;Enter participant nicknames. Separate nicknames with commas, no spaces.&quot;));</span>
<span class="nc" id="L304">		registrant.getContentPane().add(tfChatRoomParticipants);</span>
<span class="nc" id="L305">		tfChatRoomParticipants.setText(&quot;user1,user2,user3...&quot;);</span>
<span class="nc" id="L306">		registrant.getContentPane().add(btAccept);</span>
<span class="nc" id="L307">		registrant.setVisible(true);</span>
<span class="nc" id="L308">		btAccept.addActionListener(new RegistrantListener());</span>
<span class="nc" id="L309">		tfChatRoomParticipants.addKeyListener(new RegistrantListener());</span>
<span class="nc" id="L310">	}</span>
    /**
     * Get the message display component
     * @return the text area which displays the message
     */
    public JTextArea getTaOutput(){
<span class="nc" id="L316">	return taOutput;</span>
    }      


    /**
     * Get the contact list
     * @return the list component of the client window
     */
    public DefaultListModel getContactList(){
<span class="nc" id="L325">    	return model;</span>
    }
    
    /**
     * Handles actions when buttons are clicked
     * @author Bryce Filler and Max Hinson
     * @version 0.4
     */
<span class="nc" id="L333">    class LaunchChangeWindowListener implements ActionListener{</span>
<span class="nc" id="L334">    	private ClientWindow window2 = ClientWindow.getWindow();</span>
	public void actionPerformed(ActionEvent e){
	    
<span class="nc" id="L337">	    window2.launchChangeWindow();</span>

<span class="nc" id="L339">	}</span>
    }

<span class="nc" id="L342">    class RegisterChatRoomListener implements ActionListener{</span>
        public void actionPerformed(ActionEvent e){
<span class="nc" id="L344">		ClientWindow.getWindow().launchRegisterChatRoomWindow();</span>
<span class="nc" id="L345">        }</span>
    }

    /**
     * Inner class that formats the list output by JComboBox
     * Only prints name of font that exists in the list instead of entire Font object	
     */

    //helper for Fontlistener
   class FontCellRenderer extends JLabel implements ListCellRenderer&lt;Object&gt; {
<span class="nc" id="L355">     public FontCellRenderer() {</span>
<span class="nc" id="L356">         setOpaque(true);</span>
<span class="nc" id="L357">     }</span>

     public Component getListCellRendererComponent(JList&lt;?&gt; list,
                                                   Object value,
                                                   int index,
                                                   boolean isSelected,
                                                   boolean cellHasFocus) {
<span class="nc" id="L364">	 Font thisfont = (Font) value;</span>
<span class="nc" id="L365">         setText(thisfont.getName());</span>

         Color background;
         Color foreground;

         // check if this cell represents the current DnD drop location
<span class="nc" id="L371">         JList.DropLocation dropLocation = list.getDropLocation();</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">         if (dropLocation != null</span>
<span class="nc bnc" id="L373" title="All 2 branches missed.">                 &amp;&amp; !dropLocation.isInsert()</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">                 &amp;&amp; dropLocation.getIndex() == index) {</span>

<span class="nc" id="L376">             background = Color.BLUE;</span>
<span class="nc" id="L377">             foreground = Color.WHITE;</span>

         // check if this cell is selected
<span class="nc bnc" id="L380" title="All 2 branches missed.">         } else if (isSelected) {</span>
<span class="nc" id="L381">             background = Color.GRAY;</span>
<span class="nc" id="L382">             foreground = Color.WHITE;</span>

         // unselected, and not the DnD drop location
         } else {
<span class="nc" id="L386">             background = Color.WHITE;</span>
<span class="nc" id="L387">             foreground = Color.BLACK;</span>
         };

<span class="nc" id="L390">         setBackground(background);</span>
<span class="nc" id="L391">         setForeground(foreground);</span>

<span class="nc" id="L393">         return this;</span>
     }
 } 
   /**
    * Listener class that registers when the changeFont JComboBox is pressed
    * @author Xinyuan Zhang and jleeong
   */
   
    
<span class="nc" id="L402">    class FontListener implements ActionListener{</span>
	public void actionPerformed(ActionEvent e){
<span class="nc" id="L404">	    JComboBox ex = (JComboBox)e.getSource();</span>
<span class="nc" id="L405">	    Font getFont = (Font)ex.getSelectedItem();</span>
<span class="nc" id="L406">	    Font newFont = getFont.deriveFont(12F);</span>
	    //newFont.setForeground(Color.Grey);
<span class="nc" id="L408">	    taOutput.setFont(newFont);</span>
<span class="nc" id="L409">	}</span>
    }




    //******************here I start colorlistener*****************************
<span class="nc" id="L416">  class ColorListener implements ActionListener{</span>
	public void actionPerformed(ActionEvent e){
<span class="nc" id="L418">	    JComboBox ex = (JComboBox)e.getSource();</span>
<span class="nc" id="L419">	    Color newColor = (Color)ex.getSelectedItem();</span>
<span class="nc" id="L420">	    taOutput.setForeground(newColor);</span>
<span class="nc" id="L421">	}</span>
  }
   
    
    class ColorCellRenderer extends JLabel implements ListCellRenderer&lt;Object&gt; {
	 
<span class="nc" id="L427">	public ColorCellRenderer() {</span>
<span class="nc" id="L428">	    setOpaque(true);</span>
<span class="nc" id="L429">	}</span>
<span class="nc" id="L430">	boolean b = false;  </span>
    public Component getListCellRendererComponent(JList&lt;?&gt; list,
                                                   Object value,
                                                   int index,
                                                   boolean isSelected,
                                                   boolean cellHasFocus) {
<span class="nc" id="L436">	Color thiscolor = (Color) value;</span>

<span class="nc" id="L438">	String names[] = {&quot;Black&quot;, &quot;Blue&quot;, &quot;Cyan&quot;, &quot;Dark Gray&quot;, &quot;Gray&quot;, &quot;Green&quot;, &quot;Light Gray&quot;,&quot;Magenta&quot;, &quot;Orange&quot;, &quot;Pink&quot;, &quot;Red&quot;, &quot;White&quot;, &quot;Yellow&quot;};</span>
<span class="nc" id="L439">	Color colors[] = {Color.black, Color.blue, Color.cyan, Color.darkGray, Color.gray, Color.green, Color.lightGray,Color.magenta, Color.orange, Color.pink, Color.red, Color.white, Color.yellow};</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">	  for(int i = 0;i&lt;13;i++){</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">	      if (thiscolor.equals(colors[i]))</span>
<span class="nc" id="L442">		  setText(names[i]);</span>
	      }

         Color background;
         Color foreground;

         // check if this cell represents the current DnD drop location
<span class="nc" id="L449">         JList.DropLocation dropLocation = list.getDropLocation();</span>
<span class="nc bnc" id="L450" title="All 2 branches missed.">         if (dropLocation != null</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">                 &amp;&amp; !dropLocation.isInsert()</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">                 &amp;&amp; dropLocation.getIndex() == index) {</span>

<span class="nc" id="L454">             background = Color.BLUE;</span>
<span class="nc" id="L455">             foreground = Color.WHITE;</span>

         // check if this cell is selected
<span class="nc bnc" id="L458" title="All 2 branches missed.">         } else if (isSelected) {</span>
<span class="nc" id="L459">             background = Color.gray;</span>
<span class="nc" id="L460">             foreground = Color.WHITE;</span>

         // unselected, and not the DnD drop location
         } else {
<span class="nc" id="L464">             background = Color.WHITE;</span>
<span class="nc" id="L465">             foreground = Color.BLACK;</span>
         };

<span class="nc" id="L468">         setBackground(background);</span>
<span class="nc" id="L469">         setForeground(foreground);</span>

<span class="nc" id="L471">         return this;</span>
     }
 }

/**
     * Handles actions when Delete user button is clicked
     * @author Winfred Huang, Arturo Milanes, and jleeong
     * @version F16
     */
<span class="nc" id="L480">    class DeleteUserButtonListener implements ActionListener{</span>
	public void actionPerformed(ActionEvent e){
<span class="nc" id="L482">		int index = listContacts.getSelectedIndex();</span>
<span class="nc bnc" id="L483" title="All 2 branches missed.">	    if(index == 0){</span>
<span class="nc" id="L484">		controller.displayMsg(&quot;Can't delete broadcast.\n&quot;);</span>
	    }
<span class="nc bnc" id="L486" title="All 2 branches missed.">	    else if(index &gt; 0){</span>
<span class="nc" id="L487">		controller.displayMsg(&quot;You tried to delete &quot; + listContacts.getSelectedValue() +&quot;.\n&quot;);</span>
<span class="nc" id="L488">		controller.sendMsg2Server(&quot;&amp;DELETE:&quot;+listContacts.getSelectedValue());</span>
<span class="nc" id="L489">		model.remove(index);</span>
<span class="nc" id="L490">		controller.displayMsg(&quot;Successful&quot;);</span>
	    }
	    else{
<span class="nc" id="L493">		controller.displayMsg(&quot;No contact to delete. Please select one.\n&quot;);</span>
	    }
<span class="nc" id="L495">	}</span>
    }
	    /**
	     * Handles actions when Refresh button is pressed
	     * @author Winfred Huang and Arturo Milanes
	     */
<span class="nc" id="L501">	    class  OnlineCountUpdateButtonListener implements ActionListener{</span>
		public void actionPerformed(ActionEvent e){
<span class="nc" id="L503">		    int count = 1;</span>
<span class="nc" id="L504">		    ListModel&lt;String&gt; list = listContacts.getModel();</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">		    for(int i = 0; i &lt; list.getSize(); i++){</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">			if(list.getElementAt(i).endsWith(&quot;(Online)&quot;)){</span>
<span class="nc" id="L507">			    count++;</span>
			}
		    }
<span class="nc" id="L510">		    onlineCountNum.setText(String.valueOf(count));</span>
		    //revised
		    // menuPanel.add(logout,BorderLayout.EAST);
		    // launchChatWindow lCW = new lauchChatWindow();
		    
<span class="nc" id="L515">		}</span>
		
	    }
	    
	    /**
	     * Handles actions when login button is pressed or when enter is pressed on LoginWindow
	     * @author Peng Wang with Andro Stotts
	     * @version 0.4
	     */		
<span class="nc" id="L524">	    class LoginListener implements ActionListener, KeyListener{</span>
<span class="nc" id="L525">		private ClientWindow window = ClientWindow.getWindow();</span>
		private void attemptLogin(){
<span class="nc" id="L527">		    name = tfUsername.getText();</span>
<span class="nc" id="L528">		    password = new String(pfPassword.getPassword());</span>
<span class="nc bnc" id="L529" title="All 4 branches missed.">		    if(name.isEmpty()||password.isEmpty()){</span>
<span class="nc" id="L530">			tfUsername.setText(&quot;&quot;);</span>
<span class="nc" id="L531">			lblLoginError.setText(&quot;Incorrect Login Credentials&quot;);</span>
		    }
		    else{
<span class="nc" id="L534">			ip = tfServerIp.getText();</span>
<span class="nc" id="L535">			int connected = controller.connectServer(ip,name,password);</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">			if(connected==0){</span>
<span class="nc" id="L537">			    window.launchChatWindow();</span>
			}
<span class="nc bnc" id="L539" title="All 2 branches missed.">			else if(connected==1){</span>
<span class="nc" id="L540">			    tfUsername.setText(&quot;&quot;);</span>
<span class="nc" id="L541">			    lblLoginError.setText(&quot;Wrong username or password&quot;);</span>
			}
<span class="nc bnc" id="L543" title="All 2 branches missed.">			else if(connected==2){</span>
<span class="nc" id="L544">			    tfUsername.setText(&quot;&quot;);</span>
<span class="nc" id="L545">			    lblLoginError.setText(&quot;This user has logged in already&quot;);</span>
			}
			else{
<span class="nc" id="L548">			    tfServerIp.setText(&quot;&quot;);</span>
<span class="nc" id="L549">			    lblLoginError.setText(&quot;Server unavailable on this IP address&quot;);</span>
			}
		    }
<span class="nc" id="L552">		}</span>
		public void actionPerformed(ActionEvent e) {			
<span class="nc" id="L554">		    attemptLogin();</span>
		    // window.getContentPane().repaint();
<span class="nc" id="L556">		}</span>
		
<span class="nc" id="L558">		public void keyTyped(KeyEvent e) {}</span>
<span class="nc" id="L559">		public void keyReleased(KeyEvent e) {}</span>
		public void keyPressed(KeyEvent e) {
<span class="nc bnc" id="L561" title="All 2 branches missed.">		    if (e.getKeyCode() == KeyEvent.VK_ENTER) {</span>
<span class="nc" id="L562">			attemptLogin();</span>
		    }
		    else{
<span class="nc" id="L565">			lblLoginError.setText(&quot;incorrect keypress&quot;);</span>
		    }
<span class="nc" id="L567">		}</span>
	    }	
	    
	    /**
	     * Handles checkbox that toggles sound
	     * @author Bryce Filler and Max Hinson
	     * @version 0.4
	     */
	    class CheckListener implements ItemListener {
		
<span class="nc" id="L577">		public CheckListener(){};</span>
		
		public void itemStateChanged(ItemEvent e) {
<span class="nc" id="L580">		    Object source = e.getItemSelectable();</span>
		    
<span class="nc bnc" id="L582" title="All 2 branches missed.">		    if (e.getStateChange() == ItemEvent.DESELECTED)</span>
<span class="nc" id="L583">			controller.setSound(false);</span>
		    else
<span class="nc" id="L585">			controller.setSound(true);</span>
<span class="nc" id="L586">		}</span>
	    }	
	    
	/**ActionListener class used in the launchRegisterChatRoomWindow
	*@author jleeong
	*
	*@version F16
	*/
<span class="nc" id="L594">	class RegistrantListener implements ActionListener, KeyListener{</span>
		public void actionPerformed(ActionEvent e){
<span class="nc" id="L596">			sendRegistration();</span>
<span class="nc" id="L597">		}</span>
<span class="nc" id="L598">		public void keyTyped(KeyEvent e) {}</span>
<span class="nc" id="L599">		public void keyReleased(KeyEvent e) {}</span>
		public void keyPressed(KeyEvent e) {
<span class="nc bnc" id="L601" title="All 2 branches missed.">		    if (e.getKeyCode() == KeyEvent.VK_ENTER)</span>
<span class="nc" id="L602">			sendRegistration();</span>
<span class="nc" id="L603">		}</span>
		private void sendRegistration(){
<span class="nc" id="L605">			String reg = tfChatRoomParticipants.getText().trim();</span>
			//	String [] arr = reg.split(&quot;,&quot;);
			//	roomUsers = arr.length;
<span class="nc" id="L608">			controller.sendChatRoomRegistration(reg);</span>
<span class="nc" id="L609">			registrant.dispose();</span>
<span class="nc" id="L610">		}</span>
	}
	    /**
     * Handles actions when name is changed
     * @author Bryce Filler and Max Hinson
     * @version 0.4
     */
<span class="nc" id="L617">    class ChangeNickNameListener implements ActionListener, KeyListener{</span>
	//input listener for name change
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L620">	    String text = tfNickName.getText().trim();</span>
<span class="nc bnc" id="L621" title="All 2 branches missed.">		    if(!text.isEmpty())</span>
			{
<span class="nc" id="L623">			    tfNickName.setText(&quot;&quot;);</span>
<span class="nc" id="L624">			    controller.sendMsg2Server(name + &quot;(NAME_CHANGE): &quot; + text + &quot;&amp;&quot; + &quot;NAME_CHANGE&quot; + &quot;:1001&quot;);</span>
<span class="nc" id="L625">			    nicknameWindow.dispose();</span>
			}
<span class="nc" id="L627">	}</span>
<span class="nc" id="L628">	public void keyTyped(KeyEvent e) {}</span>
<span class="nc" id="L629">	public void keyReleased(KeyEvent e) {}</span>
	public void keyPressed(KeyEvent e) {
<span class="nc" id="L631">	    int key = e.getKeyCode();</span>
<span class="nc bnc" id="L632" title="All 2 branches missed.">	    if (key == KeyEvent.VK_ENTER) {</span>
<span class="nc" id="L633">		String text = tfNickName.getText().trim();</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">		if(!text.isEmpty())</span>
		    {
<span class="nc" id="L636">			tfNickName.setText(&quot;&quot;);</span>
<span class="nc" id="L637">			controller.sendMsg2Server(name + &quot;(NAME_CHANGE): &quot; + text + &quot;&amp;&quot; + &quot;NAME_CHANGE&quot; + &quot;:1001&quot;);</span>
<span class="nc" id="L638">			nicknameWindow.dispose();</span>
		    }
	    }
<span class="nc" id="L641">	}    </span>
}
	    /**
	     * Handles the action when user clicks enter on keyboard
	     * @author Peng Wang with Andro Stotts
	     * @version 0.4
	     */
<span class="nc" id="L648">	    class InputListener implements ActionListener{</span>
		public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L650" title="All 2 branches missed.">			if(listContacts.isSelectionEmpty()){</span>
<span class="nc" id="L651">				taOutput.append(&quot;***PLEASE SELECT A CONTACT PERSON FIRST, THEN SEND YOUR MESSAGE***\n&quot;);</span>
			}
			else{
<span class="nc" id="L654">				String text = tfInput.getText().trim();</span>
<span class="nc" id="L655">				tfInput.setText(&quot;&quot;);</span>
<span class="nc" id="L656">				String receiver = listContacts.getSelectedValue();</span>
<span class="nc" id="L657">				String recNoStatus = receiver;</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">				if(receiver.contains(&quot;(Online)&quot;)){</span>
<span class="nc" id="L659">					recNoStatus = receiver.substring(0,receiver.indexOf('('));</span>
<span class="nc" id="L660">					controller.sendIM(text,recNoStatus);</span>
				}
<span class="nc bnc" id="L662" title="All 2 branches missed.">				else if(receiver.contains(&quot;ChatRoom&quot;)){</span>
<span class="nc" id="L663">					String[] parts = receiver.split(&quot;:&quot;);</span>
<span class="nc" id="L664">					recNoStatus = parts[1];</span>
<span class="nc" id="L665">					controller.sendGrpMsg(text,recNoStatus);</span>
				}
			}
<span class="nc" id="L668">		}	</span>
	    }

<span class="nc" id="L671">    class LogoutListener implements ActionListener {</span>
	public void actionPerformed(ActionEvent e){
<span class="nc" id="L673">	    window.repaint();</span>
<span class="nc" id="L674">	    window.dispose();</span>
<span class="nc" id="L675">	    controller.sendMsg2Server(name+&quot;&amp;Broadcast:1008&quot;);</span>
<span class="nc" id="L676">	    window = new ClientWindow();</span>
<span class="nc" id="L677">	    window.launchLoginWindow();</span>
<span class="nc" id="L678">	}</span>
    }
<span class="nc" id="L680">    class timerThread extends java.util.TimerTask{</span>
	
	public void run (){
<span class="nc" id="L683">	    onlineCountUpdate.addActionListener(new OnlineCountUpdateButtonListener());</span>
<span class="nc" id="L684">	    onlineCountUpdate.doClick();</span>
<span class="nc" id="L685">    	}</span>
    }
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>